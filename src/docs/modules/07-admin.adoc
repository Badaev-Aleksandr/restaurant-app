== Административная панель {#admin-panel}

Контроллер `AdminPageController` отвечает за работу административного интерфейса:
- отображение страницы с формами
- создание и отмену резерваций
- просмотр резерваций
- загрузку PDF-меню

[cols="1,1,2,2",options="header"]
|===
|HTTP-метод |Путь |Параметры |Описание

|GET
|`/restaurant/admin`
|—
|Отображает главную страницу админ-панели (`admin-panel.html`).

|POST
|`/restaurant/admin/reserve`
|`reservationForm` (модель `ReservationFormDto`)
|Создаёт новую резервацию и отправляет письмо с кодом.
При ошибке валидации или отсутствии свободного столика возвращает ту же форму с сообщением.

|POST
|`/restaurant/admin/cancel`
|`reservationCode`
|Отменяет резервацию по коду.

|GET
|`/restaurant/admin/reservations/today?tableNumber=<num>`
|`tableNumber`
|Показывает список резерваций на сегодня для заданного номера столика.

|GET
|`/restaurant/admin/reservations/confirmed/by-date?date=<YYYY-MM-DD>`
|`date`
|Показывает все подтверждённые резервации на указанную дату.

|POST
|`/restaurant/admin/upload-menu`
|multipart-file `file` (PDF)
|Загружает новый PDF-файл меню.

|===

=== Пример: загрузка меню

[source,bash]
----
curl -v -u admin:password \
  -F "file=@/path/to/menu.pdf" \
  http://localhost:8080/restaurant/admin/upload-menu
----

=== Пример: создание резервации

[source,bash]
----
curl -X POST -u admin:password \
  http://localhost:8080/restaurant/admin/reserve \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "startDateTime=2025-05-05T19:00" \
  -d "endDateTime=2025-05-05T21:00" \
  -d "guestCount=4" \
  -d "customerName=Иван" \
  -d "customerEmail=ivan@example.com"
----

[NOTE]
Авторизация: все методы защищены аннотацией `@PreAuthorize("hasRole('ADMIN')")`, поэтому доступны только пользователям с ролью `ADMIN`.

=== Шаблоны Thymeleaf

Ниже список html-файлов из `src/main/resources/templates`, которые рендерят панель админа, отправляемые письма и формы:

— **admin-panel.html**
Админ-панель (AdminPageController).

— **reservation-form.html**
Форма создания резервации (`GET/POST /restaurant/reserve`).

- **cancel-form**
Форма отмены резервации.

- **download-menu-form.html**
Форма загрузки меню с панели администратора

- **email-cancel.html**
Шаблон письма при отмене резервации

- **email-template.html**
Шаблон письма при создании резервации

- **file-list.html**




